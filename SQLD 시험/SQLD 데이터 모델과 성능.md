# SQLD 데이터 모델과 성능



### Point1 정규화 

* 정규화는 데이터의 일관성, 최소한의 데이터 중복, 초대한의 데이터 유연성을 위한 벙법이며 데이터를 분해하는 과정이다.

* 정규화는 데이터 중복을 제거하고 데이터 모델의독립성을 확보하기 위한 방법이다.

* 정규화를 수행하면 비즈니스에 변화가 발생하여도 데이터 모델의 변경을 최소화할 수가 있다.

* 정규화는 제1 부터 제 5정규화까지 있지만, 실질적으로 정규화 3번까지 만 수행한다.

* 이상 현상을 막아준다.(기존의 정형화 되지 않은 데이터에 열의 제목과 다른 데이터가 있으면 새로운 쓸데 없는 데이타거 들어가는 것.) 그래서 우리는 테이블을 분해해야 한다.

* 정규화된 모델은 테이블이 분해된다. 테이블이 분해되면 직원 테이블과 부서 테이블간에 부서코드로 조인을 수행하여 하나의 합집합으로 만들 수도 있따.

* 정규화를 수행하면 불필요한 데이터를 입력하지 않아도 도기 때문에 중복 데이터가 제거된다.

  

1. 제 1 정규화 : 속서의 원자성 확보 / <u>기본키를 설정</u>
2. 제 2 정규화 : 기본키가 2개이상으로 이루어진 경우, **<u>부분 함수 종속성을 제거</u>**(분해)한다.
3. 제 3 정규화 : 기본키를 제외한 칼럼 간에 종속성을 제거한다. + **<u>이행 함수 종속성을 제거</u>** 한다.
4. BCNF : 기본키를 제외하고 후보키가 있는 경우, 후보키가 기본키를 종속시키면 분해한다.
5.  제 4 정규화 :  여러 칼럼들이 하나의 칼럼을 종속시키는 경우 분해하여 다중 값 종속성을 제거한다.
6. 제 5 정규화 :  조인에 의해서 종속성이 발생되는 경우 분해한다.



### 함수적 종속성



#### 함수적 종속성

1. 제 1 정규화 

   :**<u>정규화는 함수적 종속성을 근거로 한다.</u> **함수적 종속성이란 x ->y 이면 y 는 x 에 함수적으로 종속한다고 말한다.  함수적 종속성은 x 가 변화하면 y도 변화하는지 확인한다. **<u>기본키를 잡는 것이 제 1 정규화이다.</u>**

2. 제 2 정규화

   :부분 함수 종속성이란 , 기본기가 2개이상의 칼럼으로 이루어진 경우에만 발생한다. 그래서 기본키가 1개인 경우에는 제 2 정규화를 패스한다.  <u>**제 2 정규화에서 핵심은 부분함수 종속성 이다.**</u>  만약 많은 키들 중에서 회원 아이디와  이름만이 함수적으로 종속하고 있다면  부분 함수 종속성이라고 한다. 이런  제2 정규화에서는 부분함수 종속성을 제거해야 한다. 그렇게 되면 이름이 종속한 회원아이디의 테이블이 도출되고 회원 아이디가 기본키가 된다.

3. 제 3 정규화

   : 제 3 정규화는 **<u>기본키를 제외하고 칼럼간의 종속성이 발생하는 이행 함수 종속성을 제거 </u>**한다. 그래서 이를 제거/분해 하고 나면 종속되었던 컬럼 값이 기본키가된 테이블이 만들어진다.



데이버베이스 키

* 기본키 : 후보키 중에서 엔터티를 대표할 수 있는 키
* 후보키 : 후보키는 유일성과 최소성을 만족하는 키
* 슈퍼키 : 슈퍼키는 유일성은 맍고하지만 최소성을 만족하지 않는 키이다.
* 대체키 :  대체키는 여러개의 후보키 중에서 기본키를 선정하고 남은 키

​		

4. BCNF

   * 복수의 후보키가 있고 후보키들이 복합 속성이어야 하며, 서로 중첩되어야 한다.  
   * 위의 예처럼 기본키가 교수를 함수적으로 종속하고 있따.
   * 이때 교수가 후보키이고 교수가 과목 번호를 함수적으로 종속하는 경우 분해가 일어난다.
   * 즉 위와 같은 경우 교수 테이블을 새롭게 만들고 기본키는 교수로 하고 칼럼은 과목 번호가 된다.

   

   

## 정규화와 성능



### 정규화와 문제점

* 정규화는 테이블을 분해해서 데이터 중뷰ㅗㄱ을 제거학 때문에 데이터 모델의 유연성을 높인다.
* BUT
* 정규화는 데이터 조회 select 시에 조인 을 유발하기 때문에 컴퓨터 성능이 좋아야한다.
*  그래서 이러한 점을 고치기 위해서 반정규화가 있다.



### 정규화를 사용한 성능 튜닝

*  한 기본키를 가지고 거기에 종속을 하고 있는 여러 칼럼들이 늘어나면 DB의 입출력 단위의 블록의 크기를 넘어서게 된다. 이렇게 되면 한 행을 읽기 위해서 여러게의 블록을 읽게 되고 Disk io가 증가하기 때문에 성능이 떨어지게 된다.  => 입출력 데이터의 양을 낮추는 정규화를 한다.





## 반정규화



### 반정규화

: 데이터 베이스의 성능 향상을 위하여, 데이터 중복을 허용하고 조인을 줄이는 데이터 베이스 성능 향상법이		다. 조회 속도를 향상하지만 졔좌마스트어에 열로 쭉 밀어 넣은 것 처러므 유연성은 낮아진다. 



### 반정규화를 수행하는 경우

*  정규화에 충실하면 종속성 활용성은 향상되지만 수행 속도가 느려서지는 경우
* 다량의 범위를 자주 처리해야 하는 경우
* 특정 범위의 데이터만 자주 처리하는 경우
* 요약 집계 정보가 자주 요구 되는 경우



### 반정규화 기법

1. 계산된 칼럼 추가: 배치 프로그램으로 총판매엑 평균장고, 계좌 평가 등을 미리 계산하고 그결과를 특정 칼럼에 추가한다.
2. 테이블 수직 분할: 하나의 테이블을 두개 이상의 테이블로 분할한다. 즉 칼럼을 분할하여 새로운 테이블을 만드는 것이다.

3. 테이블 수행 분할: 하나의 테이블에 있는 값을 기준으로 테이블 분할하는 방법
   1. 파티션: 논리적으로는 하나의 테이블이지만 여러개의 테이블 파일에 분산되어서 저장된다.
      1. 테이터 조회시에 엑세스 범위가 줄어들기 때문에 성능이 향상된다.
      2. 데이터가 분할되어 있기 때문에  io의 성능이 향상된다.
      3. 각 파티션을 독립적으로 백업 및 복구가 가능하다.
4. 테이블 병합
   1.  1대1 관계의 테이블을 하나의 테이블로 병합해서 성능을 향상 시킨다. 
   2. 1대 N관계의 테이블을 병합하여 성능을 향상시킨다. 하지만 많은 야의 데이터 중복이 발생한다.
   3. 슈퍼 타입과 서브타입 관계가(부모와 자식관계) 발생하면 테이블을 통합하여 성능을 향상 시킨다. /  배타적 포괄적인 관계 라는 것이 있따. 이는 그 고객 콜럼이 있다면 , 그 고객은 개인 고객일 수도 있고ㅡ 법인 고객일 수 도 있따.



* 슈퍼 타입 및 서브 타입 변환 방법
  * one To one Type : 슈퍼타입과 거브타입을 개별 테이블로 도출한다. / 테이블의 수가 많아서 조인이 많이 발생하고 관리가 어렵다.
  * plus type :  슈퍼 타입과  서브 타입 테이블로 도출하고 있다. 조인이 발생하고 관리가 어렵다.
  * single type:  슈퍼 타입과 서브 타입을 하나의 테이블로 도출한다. 조인 성능이 좋고 관리가 편리하지만 io 성능이 나쁘다.



### 분산 데이터 베이스



	#### 분산 데이터 베이스

* 집중형 데이터 베이스: 한대의 컴퓨터에 여러면의 사용자가 데이터 베이스 관리 시스템에 접속하여 데이터 베이스를 사용하는 중앙 집중형 구조
* 분산 데이터 베이스: 물리적으로 떨어진 데이터 베이스에 네트워크로 연결하여 단일 데이터베이스 이미지를 보여 주고 분산된 작업 처리를 수행하는 것 = > **<u>투명성 제공</u>**
  * 투명성의 종류
    1. 분할 투명성: 고객은 하난의 논리적 릴레이션이 여러 단편으로 분할되어 각 단편의 사본이 여러 시스템에 저장되어 있음을 인식할 필요가 없다.
    2. 위치 투명성 :  고객이 사용하려는 데이터의 저장 장소를 명시할 필요가 없다. / 고객은 데이터가 어느 위치에 있더라도 동일한 명령을 사용하여 데이터에 접근 할 수 있어야 ㅜ한다.
    3. 지역 사상 투명성 :  지역 DBMS 와 물적 데이터베이스 사이의 사상이 보장됨에 따라 각 지역 시스템이름과 무관한 이름이사용 가능하다. 
    4. 중복 투명성 : 데이터 베이스 객체가 여러 시스템에 중복되어 존재함에도 고객과는 무관하게 데이터의 일관성이 유지된다.
    5. 장애 투명성: 데이터베이스가 분산되어 있는 각 지역의 시스템이나 통신망에 이상이 발생해도 데이터의 무결성은 보장된다.
    6. 병행 터명성 : 여러 고객의 응용프로그램이 동시에 분산 데이터베이스에 대한 트랜잭션을 수행하는 경우데도 결과에 이상이 없다. 



#### 분산 데이터 베이스 설계 방식

상향식 설계 방식: 지역 스키마 작성 후 향후 전역 스키마를 작성하여 분산 데이터베이스를 구축한다.

​	

하향식 설계 방식:  전역 스키마 작성 후 해당 지역 사상 스키마를 작성하여 분산 데이터 베이스를 구축한다.



#### 데이터베이스 장점과 단점

**장점** 

* 데이터 베이스 신뢰성과 가용성이 높다.
* 분산 데이터 베이스가 병렬 처리를 수행하기 때문에 빠른 응답이 가능하다.
* 분산 데이터 베이스를 추가하여 시스템 용량 확장이 쉽다.



단점

* 데이터베이스가 여러 네트워크를 통해서 분리되어 있기 때문에 관리와 통제가 어렵다.
* 보안 괸리가 어렵다ㅣ
* 데이터 무결성 관리가 어렵다.
* 데이터 베이스 설계가 복핟.



























